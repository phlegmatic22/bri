<?xml version="1.0" encoding="UTF-8"?>
<ActiveReportsLayout Version="3.1" PrintWidth="11115" DocumentName="ActiveReports Document" ScriptLang="C#" UserData="AAEAAAD/////AQAAAAAAAAAEAQAAABxTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlBwAAAApMb2FkRmFjdG9yB1ZlcnNpb24IQ29tcGFyZXIQSGFzaENvZGVQcm92aWRlcghIYXNoU2l6ZQRLZXlzBlZhbHVlcwAAAwMABQULCBxTeXN0ZW0uQ29sbGVjdGlvbnMuSUNvbXBhcmVyJFN5c3RlbS5Db2xsZWN0aW9ucy5JSGFzaENvZGVQcm92aWRlcgjsUTg/AAAAAAoKCwAAAAkCAAAACQMAAAAQAgAAAAAAAAAQAwAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAA==" MasterReport="0">
  <StyleSheet>
    <Style Name="Normal" Value="font-family: Arial; font-style: normal; font-variant: inherit; font-weight: normal; font-size: 10pt; font-size-adjust: inherit; font-stretch: inherit; color: rgb(0,0,0); background-repeat: inherit; background-attachment: inherit; opacity: inherit; word-spacing: inherit; letter-spacing: inherit; text-decoration: none; vertical-align: inherit; text-transform: inherit; text-align: inherit; text-indent: inherit; unicode-bidi: inherit; line-height: inherit; white-space: inherit; ddo-char-set: 0" />
    <Style Name="Heading1" Value="font-family: inherit; font-style: inherit; font-variant: inherit; font-weight: bold; font-size: 16pt; font-size-adjust: inherit; font-stretch: inherit" />
    <Style Name="Heading2" Value="font-family: Times New Roman; font-style: italic; font-variant: inherit; font-weight: bold; font-size: 14pt; font-size-adjust: inherit; font-stretch: inherit" />
    <Style Name="Heading3" Value="font-family: inherit; font-style: inherit; font-variant: inherit; font-weight: bold; font-size: 13pt; font-size-adjust: inherit; font-stretch: inherit" />
  </StyleSheet>
  <Sections>
    <Section Type="ReportHeader" Name="ReportHeader" Height="1125" BackColor="16777215">
      <Control Type="AR.Field" Name="TextBox1" Tag="8" Left="180" Top="810" Width="6660" Height="288" Text="DateTime" Style="white-space: inherit" />
      <Control Type="AR.Image" Name="Picture" Left="9000" Top="90" Width="1980" Height="630" LineColor="16777215" LineWeight="0">0D0D000402D308000089504E470D0A1A0A0000000D4948445200000078000000280802000000BA88A972000000017352474200AECE1CE90000000467414D410000B18F0BFC61050000001974455874536F6674776172650041646F626520496D616765526561647971C9653C00000858494441546843ED9AF953535714C7FB6FB59DE94C3B5D42EB0A52041104C482B258F7655A4A415CEA46513A5A17C0CA22B2D5B468A1A3690BB2694880AC84908414838A216C61D1F48BF7CEE5F25E125E54527F78DF39E324E79CFB72FDBCFBCE3D37E41D9FACB048061D26C9A0C32419749824830E9364D0A169726E5239D870CD74B56BA4FDC58B17D42B4132E810E41C77263725AE562AD6362AD6DD51E4761DF6CE7B696C39C9A0A56AC8E38C6BD8A4A8517CD1A060ACBFE9DC2F91B50C5A921C6E676479FC4765119F562A04ACF7B5654FCE4DD0BCC07AC762B16C4ED8B26AF55A62B171F12E978B0697CA66B3B134586E6E1E0D04565E7E01CB3F70F010F5FE1F9A9898A8BA519D9199FDDBEF8DD42559B37373F661475459E2079722C0FA1311EBBD12582FACE8D6D6FB0C07ACA4A494C404BA515DCDA7DDBE7D870602EB2D016D3299E237279269DCBFDF46BDD2343B3B6BB33BAC83369BF3B5582F80C6EE9994BC9511D99ABA8DC404DAB3771FCB59BD66DDB367CF6820B0DE06D073F3F30989496C1A1AAD960624C83B333360B55906AC03D641B0760C3B63AFA72EB2BE19026B5AA32F5DBEC2A602331A4DC4CFE4768F012E4B00741A08AAB701B4D56A65738099CDFD34B09CBC5E6FBFC56A325BCCFD03AFCF9A82D6E974FC6CC09DF8999A9A9AF9849B35B53410546F03688B6580CD0186B7341054A06C32F71B8C26A3A93F18EB0AA9AC2968548F046E4BDC929422E8C6F38F2C22830D0D39B1BDA8D5EA5F6F29ABAB6F5E2FAFA8ACAC6ABC7DC76030F003838076BBDD5A6D0F0A7D4D4D2D86E3CE757474CECCCC2084B2A8D71BFEF8A3A9AAEA4679798552F99B4EAFF77B3AC0455A5A5A6B6BEB9086693435358123CBF478C6B1B1777676B139C0F0164EA2D1D1519229D0B4D70BC43ABD416F308A59BB5C23AEF1C7D1BF2487C49A82868A8B7FE227046434E0F3E1FFBF213A8685D2D2773C7FFE9CEF557843B9073232500C1AC8CE17FFB4EDAB74E6E72D6ED3E69C9CDCC8A868811F96BE3D835F8CB8CDA74F9F59B72E7235368CA5B6634726CA05722E5EBC24B888C0FC3E64D3D3D340DCDBA7EBD3E9C5AC87875DE44686CA7A117477B7869FC4858B3FD380CFD7DEDEC1874A4ACB04C9024335C7468F8162D0BC2754C39E363139898BE0C667677F2DE0CB5B7C7C02F6EA57000DCA40ACD1F6F6F4F689593BFF1DE61FAC90582F82C622DD18BB894D2239652B0DF87C858545CC0FC3623F77BE98F788ED48C1510C7CB3A061F50DBFE2227575F53CD6F5EBA3D2D2D253525279278A49A8A0A7A6A6B53D7DEA6E6DB7A647CC1AD5525CBEA4B35E040D09805A0707E1447BC4DF0094727CDED5AB258D8DB75149474646F014A3DEA1E0EEDABD87A5C56C8CC3D8E0A0D1DB02C72DA512359AF5B9C4CE9C2DACADAB47E8CC9942DEFF6DCE77B8485ADA76063433331BB5184E48ABD532FFAE5D7BEEDD5361F8F779F9FC15F0164E6228EB642034353505BE0F1E763F546BC4ACED8E213165A2E0AC77B6A68FCDB891B604346A2B3F27EC45700AAA04D63249160BACF94CEC69C141F30BAAADBD9DF961E8826860E9106C00D800194DD8EF4B4F7A494929C41F15154D3C52BA8EC9A929F0EDEC7AD8F5402D666DB3DB0351260ACE3AAB25CD333BB60434D0447FB991CD69F7EEBD700AAA04B8C389558CA7F8E8B1E368A833B3B2F71F38585070ECDCB9F37C2672A4837E3A3ACAFC30FEFC86A333F3C7C4C4EAF57A4619969ABA2D2B2B9B19F8B2100A2E864B013D36E679FCF8C9823D79FA04F6141A5D30F425A3CF5054695E600DB9FF6D36A99AFB557F5A5477ADAA7B3695CAA1520DA9FE72AADA1EB5E23E2D010D1D3B7682CD097B1A3E896FFB36C56FC6A7A2BF49DC92CC9C812C24D0E85B991FD6DCFC270DF87C68EFF85057D7038632B86102182E69454F4E612DB7777475743E10AF6BF4CECBAEE80D65C9EF1645BC773EE2839F233E2C8DF8B83CE2B36AC5E7758A55B714997F8B563474F7EE3D7E5A821249EAC60F274FF1CE4016126888F9613C68BCE6432B011A7A65D68CF2FBFE2867FDEDAF4643E3E3E36BD6AEE767C61BA91BFCDEF8555A7A5B5B9BC96CEEE9ED152CBD15028D9E87A75952528A04BF36373787E1124143AFC07A9172B11FCABB5B02741D44070F1DE667C68CD40DD471DE595A7A8D0EC3A7BA5C7C6885402F7CEBC281C60192E605900034766C1AF0A790584BA70CF9018D5D8E9F1933B4A5880A4013279118F4891327D9DBBDFB0E20E7F541C3B37D7B06039D92B2155D26D9AFE6E7E7B1A1A9D5EA818185932191DDEEE0879F3C751AB70A471EF849FF2A9044D6215186FC807EF4E8113F3366ECA18B8D5B2C1D382E9F3A751AB8F1AFE0600DD068B7D95B342718FB46400B0E2CC4A2A363D8EBA2A273642C04A6818AE1F1133FD0A4A55A96B5CB33121265C80F682823234B302778682C94CD10B59BBD45F782B16F04349E2A9C471856B1EDDCB98B8C25CAF92E97BF02B3E494549A215210D606B339E65A6A489421FFA0CBAEFD22981316118D2D94889140DF0A11435FB86FFF01746C48AEACAC625F647B3C9E37021AC269F0C89102015F6691911B50464826E47038B0C1F017618632429344F2CB5A6F32BE0265C83F68B4CF3832F086E549632F850DBDA5B5F5F2E52BE8BBC12EF7FB3CBCB870E1627D7D8346A3997CF9D50F93DD6EAFA8A8C4A9DA6834198C4676CDBEBEC5E31FC4FC309CECA9D7E7C36B3E44BD2F852BE3188DAA9597979F9F5F70F66CE1F5EBE5FFFCD322FEEB0FEE31E686028D2338265CF863514D4D2DE613BC41066BC065ACFB0C0601E54FA45186FC8396C5343DED45C5006B8DAE777D4922A57C89505648A40CC9A0971758F71875AF431992414B92C3ED5C7325DE2FE53DADCB538664D052457E4323A07CB85DFEA5D20A68C8E38C6F486094733A0EC9BFBD5B294DCC4E28079425BACBEDAEFB2F7CC13A168164D061920C3A4C9241874932E8B0C8E7FB0F105E7E40C548B74D0000000049454E44AE426082</Control>
    </Section>
    <Section Type="PageHeader" Name="PageHeader" Height="0" BackColor="16777215" />
    <Section Type="Detail" Name="Detail" Height="10903" BackColor="16777215">
      <Control Type="AR.Field" Name="TextBox2" Tag="9" Left="2700" Top="1080" Width="8100" Height="288" Text="AuthorGroup" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox3" Tag="10" Left="2700" Top="630" Width="8100" Height="288" Text="Title" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox4" Tag="11" Left="2700" Top="1530" Width="8100" Height="288" Text="Description" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox5" Tag="12" Left="2700" Top="1980" Width="8100" Height="288" Text="LossStart" OutputFormat="" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox10" Tag="13" Left="2700" Top="2430" Width="8100" Height="288" Text="LossEnd" OutputFormat="" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox11" Tag="14" Left="5670" Top="4140" Width="2610" Height="288" Text="TotalLoss" Style="text-align: right; white-space: nowrap" />
      <Control Type="AR.Subreport" Name="SubReport" DataField="EntrySubLoss" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2520" Top="2790" Width="8280.001" Height="1260" ReportName="SubLossSubReport" />
      <Control Type="AR.Field" Name="TextBox13" Tag="20" Left="2700" Top="5040" Width="8100" Height="288" Text="CauseTag" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox14" Tag="21" Left="2700" Top="5490" Width="8100" Height="288" Text="CauseDescription" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox17" Tag="24" Left="2700" Top="6480" Width="8100" Height="288" Text="Actions" />
      <Control Type="AR.Field" Name="TextBox31" Tag="&lt;FieldConfigurationDS xmlns=&quot;http://tempuri.org/ChartConfiguration.xsd&quot;&gt;&#xD;&#xA;  &lt;FieldConfiguration FieldConfiguration_Id=&quot;0&quot;&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;DataBinding&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;      &lt;Property&gt;&#xD;&#xA;        &lt;Name&gt;DataField&lt;/Name&gt;&#xD;&#xA;        &lt;Value&gt;27&lt;/Value&gt;&#xD;&#xA;        &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;        &lt;CustomData /&gt;&#xD;&#xA;        &lt;Description /&gt;&#xD;&#xA;      &lt;/Property&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;  &lt;/FieldConfiguration&gt;&#xD;&#xA;&lt;/FieldConfigurationDS&gt;" Left="2700" Top="9450" Width="8100" Height="288" Text="Link" HyperLink="8" Style="white-space: inherit" />
      <Control Type="AR.Subreport" Name="SubReport1" DataField="EntryComment" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2520" Top="9900" Width="8280" Height="810" ReportName="lossComments" />
      <Control Type="AR.Line" Name="Line" X1="269.28" Y1="990.72" X2="10800" Y2="989.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line1" X1="269.28" Y1="2790.72" X2="10800" Y2="2789.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line2" X1="269.28" Y1="4500.72" X2="10800" Y2="4499.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line3" X1="269.28" Y1="4950.72" X2="10800" Y2="4949.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line4" X1="269.28" Y1="5400.72" X2="10800" Y2="5399.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line5" X1="269.28" Y1="5850.72" X2="10800" Y2="5849.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line6" X1="269.28" Y1="6390.72" X2="10800" Y2="6389.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line7" X1="269.28" Y1="6840.72" X2="10800" Y2="6839.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line8" X1="269.28" Y1="7290.72" X2="10800" Y2="7289.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line9" X1="269.28" Y1="9810.721" X2="10800" Y2="9809.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line10" X1="269.28" Y1="2340.72" X2="10800" Y2="2339.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line11" X1="269.28" Y1="1890.72" X2="10800" Y2="1889.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line12" X1="269.28" Y1="1440.72" X2="10800" Y2="1439.28" LineColor="14805985" />
      <Control Type="AR.Line" Name="Line13" X1="2520" Y1="4050" X2="10890" Y2="4050" LineColor="14805985" />
      <Control Type="AR.Subreport" Name="SubReport2" DataField="Entry_CauseClasses" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2700" Top="4590" Width="8100" Height="270" ReportName="lossCauseClassesSubreport" />
      <Control Type="AR.Subreport" Name="SubReport3" DataField="Entry_ActionClasses" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2700" Top="5940" Width="8100" Height="270" ReportName="lossActionClassesSubreport" />
      <Control Type="AR.Subreport" Name="SubReport4" DataField="Entry_StateClasses" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2700" Top="6930" Width="8100" Height="270" ReportName="lossStateClassesSubreport" />
      <Control Type="AR.Field" Name="TextBox" Tag="&lt;FieldConfigurationDS xmlns=&quot;http://tempuri.org/ChartConfiguration.xsd&quot;&gt;&#xD;&#xA;  &lt;FieldConfiguration FieldConfiguration_Id=&quot;0&quot;&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;DataBinding&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;      &lt;Property&gt;&#xD;&#xA;        &lt;Name&gt;DataField&lt;/Name&gt;&#xD;&#xA;        &lt;Value&gt;51&lt;/Value&gt;&#xD;&#xA;        &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;        &lt;CustomData /&gt;&#xD;&#xA;        &lt;Description /&gt;&#xD;&#xA;      &lt;/Property&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;  &lt;/FieldConfiguration&gt;&#xD;&#xA;&lt;/FieldConfigurationDS&gt;" Left="270" Top="90" Width="10530" Height="288" Text="EntryType" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label" Left="270" Top="630" Width="2430" Height="288" Caption="Setting.entryTitle" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label1" Left="270" Top="1080" Width="2430" Height="288" Caption="Reports.AuthorGroup" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label2" Left="270" Top="1530" Width="2430" Height="288" Caption="Setting.description" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label5" Left="270" Top="2880" Width="2250" Height="540" Caption="Setting.classifiedLosses" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label6" Left="2700" Top="4140" Width="2970" Height="288" Caption="Setting.totalLoss" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label7" Left="270" Top="4590" Width="2430" Height="288" Caption="Setting.causeClasses" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label8" Left="270" Top="5040" Width="2430" Height="288" Caption="Setting.causeTag" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label9" Left="270" Top="5490" Width="2430" Height="288" Caption="Setting.causeDescription" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label10" Left="270" Top="5940" Width="2430" Height="288" Caption="Setting.actionClasses" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label11" Left="270" Top="6480" Width="2430" Height="288" Caption="Setting.actions" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label12" Left="270" Top="6930" Width="2430" Height="288" Caption="ControlPanels.SearchPanel.Label.HandlerState" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label13" Left="270" Top="9450" Width="2430" Height="288" Caption="Setting.link" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label14" Left="270" Top="9900" Width="2250" Height="288" Caption="Reports.Comments" Style="font-weight: bold" />
      <Control Type="AR.Line" Name="Line14" X1="269.28" Y1="9360.721" X2="10800" Y2="9359.28" LineColor="14805985" />
      <Control Type="AR.Label" Name="Label15" Left="270" Top="7380" Width="2430" Height="450" Caption="Setting.pictureAttachment" Style="font-weight: bold" />
      <Control Type="AR.Label" Name="Label16" Left="270" Top="8820" Width="2430" Height="450" Caption="Setting.fileAttachment" Style="font-weight: bold" />
      <Control Type="AR.Line" Name="Line15" X1="269.28" Y1="8730.721" X2="10800" Y2="8729.28" LineColor="14805985" />
      <Control Type="AR.Subreport" Name="SubReport5" DataField="FileAttachments" Tag="Query.DNAdiary.Entries.GetEntryDetailView" Left="2700" Top="8820" Width="8100" Height="270" ReportName="lossFileAttachment" />
      <Control Type="AR.Image" Name="PicIcon" Left="2700" Top="7380" Width="1980" Height="1260" LineColor="16777215" LineWeight="0" SizeMode="2" PictureAlignment="0" />
      <Control Type="AR.Field" Name="TextBox7" Visible="0" Tag="65" Left="4770" Top="7380" Width="2250" Height="288" Text="PictureAttachmentLink" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox8" Visible="0" Tag="66" Left="4860" Top="7740" Width="3240" Height="288" Text="PictureAttachmentFullPath" Style="white-space: inherit" />
      <Control Type="AR.Field" Name="NoPicTB" Left="2790" Top="7830" Width="1800" Height="540" Text="Reports.NoPicture" Style="color: Red; font-size: 9pt; font-weight: bold; text-align: center; vertical-align: middle; white-space: inherit" />
      <Control Type="AR.Field" Name="LossStartTB" Left="270" Top="1980" Width="2430" Height="270" Text="Reports.LossStart" Style="font-weight: bold; white-space: inherit" />
      <Control Type="AR.Field" Name="LossEndTB" Left="270" Top="2430" Width="2430" Height="270" Text="Reports.LossEnd" Style="font-weight: bold; white-space: inherit" />
      <Control Type="AR.Line" Name="Line16" X1="10890.72" Y1="0" X2="90.7196" Y2="0" LineColor="13684944" />
      <Control Type="AR.Line" Name="Line17" X1="0" Y1="0" X2="11102.4" Y2="0" LineColor="5726464" />
      <Control Type="AR.Line" Name="Line18" X1="0" Y1="463.6801" X2="11102.4" Y2="463.6801" LineColor="5726464" />
    </Section>
    <Section Type="PageFooter" Name="PageFooter" Height="0" BackColor="16777215" />
    <Section Type="ReportFooter" Name="ReportFooter" Height="0" BackColor="16777215" />
  </Sections>
  <ReportComponentTray />
  <Script><![CDATA[//*************************************************************************
// Copyright (C) Metso Automation Inc.
//
// Hierarchy code  :
// Author/date     : Anna Sharonova / 12.09.2006
// Documents       : 
// Description     : Basic report script for DNAdiary.
//				   : Provides report localization with using of 
// 				   : Query.DNAdiary.Entries.GetStrings method  
//
// Comments		   : In this version text values of labels are used as 
//				   : localization keys. Only labels are localized. 
//				   : It means that textboxes are data bound fields and 
//				   : don't require any localization.
//
// CHANGE HISTORY
// 
// 15.09.2006 Anna Sharonova
// Comment
// The possibility of textboxes localization added. 
// To localize textbox it is necessary to place its name to 'tbs' array
// as string value and to set local key as textbox text.   
//
//
// 22.09.2006 Anna Sharonova
// Comment
// Attachment picture thumbnail output script added. 
// Endcomment
//
//
// 08.10.2006 Anna Sharonova
// Comment
// Picture loading error label rendering added.
// Endcomment
//
// Modified
//
//*************************************************************************/

public void Detail_Format()
{
	// string array for localizable textboxes
	string[] tbs = new string[] {"EditLinkTB","DeleteLinkTB","NoPicTB","LossStartTB","LossEndTB"};
	// number of controls on the detail section
	int count = rpt.Sections["Detail"].Controls.Count;
	// variable to collect all labels default values
	string labs = "";
	// select all labels and needed textboxes from controls and collect their values
	for (int i=0; i<count; i++)
	{
		// if control type is 'Label'
		if (rpt.Sections["Detail"].Controls[i].GetType().ToString() == "DataDynamics.ActiveReports.Label")
		{
			// get its text value to use it as key for getting localization string
			DataDynamics.ActiveReports.Label lbl = (Label)rpt.Sections["Detail"].Controls[i];
			labs += lbl.Text + "\r\n";
		}
		// if control type is 'TextBox'
		if (rpt.Sections["Detail"].Controls[i].GetType().ToString() == "DataDynamics.ActiveReports.TextBox")
		{
			DataDynamics.ActiveReports.TextBox tb = (TextBox)rpt.Sections["Detail"].Controls[i];
			// check if textbox name is 'tbs' array in
			int ind = System.Array.IndexOf(tbs,tb.Name);
			if (ind!=-1)
			{
				// if ok add its value to key string
				labs += tb.Text + "\r\n";			
			}
		}
	}
	// if key string was added with some value
	// remove two last simbols '\r\n' to get right array 
	if (labs.Length > 2)
		labs = labs.Substring(0,labs.Length - 2); 
	// convert string value to array of strings to use as request parameter
    string[] labs_ar = labs.Replace("\r","").Split('\n');
    labs = "";
    // create method request object
    Metso.DNA.IA.DNAdata.Interfaces.IDNAdataObject dobj = (Metso.DNA.IA.DNAdata.Interfaces.IDNAdataObject)
      Metso.DNA.IA.DNAdata.RemoteUtils.CreateRemote("DNAdataObject");
    // get user language information using current thread
    System.Collections.Specialized.NameValueCollection additionalSettings = new System.Collections.Specialized.NameValueCollection();
    additionalSettings.Add("langid", System.Threading.Thread.CurrentThread.CurrentUICulture.Name);

	// try to invoke the localization method
	try
	{
	    // invoke Query.DNAdiary.Entries.GetStrings method
	    System.Data.DataSet ds = (System.Data.DataSet)dobj.InvokeMethod("GetStrings", "$DNAdiary/Query.DNAdiary.Entries",additionalSettings, labs_ar, null);
		
		// for each report detail section label control try to find value from result dataset 
		for (int i=0; i<count; i++)
		{
			// if control type is 'Label' 
			if (rpt.Sections["Detail"].Controls[i].GetType().ToString() == "DataDynamics.ActiveReports.Label")
			{
				DataDynamics.ActiveReports.Label lbl = (Label)rpt.Sections["Detail"].Controls[i];
            	// use default text value of label as key to get localization string
            	// and find result using this key 
            	System.Data.DataRow[] str = ds.Tables["Strings"].Select("key = '" + lbl.Text + "'");
            	// if result string isn't empty, change label text with local string
            	if (str[0][1].ToString() != null && str[0][1].ToString() != "")
            		// add colon sign to the end of text if there is no this one
            		if (lbl.Text.Substring(lbl.Text.Length-1,1) != ":")
	            		lbl.Text = str[0][1].ToString()+":";
	            	else
	            		lbl.Text = str[0][1].ToString();
			}
			// if control type is 'TextBox'
			if (rpt.Sections["Detail"].Controls[i].GetType().ToString() == "DataDynamics.ActiveReports.TextBox")
			{
				DataDynamics.ActiveReports.TextBox tb = (TextBox)rpt.Sections["Detail"].Controls[i];
				// check if textbox name is 'tbs' array in
				int ind = System.Array.IndexOf(tbs,tb.Name);
				if (ind!=-1)
				{
            		System.Data.DataRow[] str = ds.Tables["Strings"].Select("key = '" + tb.Text + "'");
            		// if result string isn't empty, change textbox text with it
            		if (str[0][1].ToString() != null && str[0][1].ToString() != "")
	        	    		tb.Text = str[0][1].ToString();
					
				}			
			}
		}
	}
	catch
	{
		// ignore to leave labels with default values
	}

	//*********************************************************/
	// Picture attachment script part
	//*********************************************************/
	DataDynamics.ActiveReports.TextBox PicIconUrl = 
		(TextBox)rpt.Sections["Detail"].Controls["TextBox7"];
	DataDynamics.ActiveReports.TextBox PicIconPath = 
		(TextBox)rpt.Sections["Detail"].Controls["TextBox8"];
	DataDynamics.ActiveReports.TextBox noPicTB = 
		(TextBox)rpt.Sections["Detail"].Controls["NoPicTB"];
	DataDynamics.ActiveReports.Picture PicIcon = 
		(Picture)rpt.Sections["Detail"].Controls["PicIcon"];

	PicIcon.HyperLink = PicIconUrl.Text;
	try
	{
		if (PicIconPath.Text != "")
		{
      System.Data.DataSet ds = (System.Data.DataSet)dobj.InvokeMethod("GetAttachmentData", "$DNAdiary/Metso.DNA.IA.DNAdata.BinaryDataRepository.Manager",additionalSettings, PicIconPath.Text, "");
      byte[] buffer = (byte[])ds.Tables[0].Rows[0]["BinaryData"];
      System.IO.Stream s = new System.IO.MemoryStream(buffer);
			PicIcon.Image = System.Drawing.Image.FromStream(s);;
		}
		noPicTB.Visible = false;
	}
	catch
	{
		PicIcon.Visible = false;
		noPicTB.Visible = true;
	}
	
}
]]></Script>
  <PageSettings />
  <Parameters />
</ActiveReportsLayout>