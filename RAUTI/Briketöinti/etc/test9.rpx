<?xml version="1.0" encoding="UTF-8"?>
<ActiveReportsLayout Version="3.1" PrintWidth="18420" DocumentName="ARNet Document" ScriptLang="C#" UserData="AAEAAAD/////AQAAAAAAAAAEAQAAABxTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlBwAAAApMb2FkRmFjdG9yB1ZlcnNpb24IQ29tcGFyZXIQSGFzaENvZGVQcm92aWRlcghIYXNoU2l6ZQRLZXlzBlZhbHVlcwAAAwMABQULCBxTeXN0ZW0uQ29sbGVjdGlvbnMuSUNvbXBhcmVyJFN5c3RlbS5Db2xsZWN0aW9ucy5JSGFzaENvZGVQcm92aWRlcgjsUTg/AAAAAAoKCwAAAAkCAAAACQMAAAAQAgAAAAAAAAAQAwAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAA==" MasterReport="0">
  <StyleSheet>
    <Style Name="Normal" Value="font-family: Arial; font-style: normal; text-decoration: none; font-weight: normal; font-size: 10pt; color: Black" />
    <Style Name="Heading1" Value="font-size: 16pt; font-weight: bold" />
    <Style Name="Heading2" Value="font-family: Times New Roman; font-size: 14pt; font-weight: bold; font-style: italic" />
    <Style Name="Heading3" Value="font-size: 13pt; font-weight: bold" />
  </StyleSheet>
  <Sections>
    <Section Type="ReportHeader" Name="ReportHeader1" Height="63200" BackColor="16777215">
      <Control Type="AR.Field" Name="TextBox9" Tag="&lt;FieldConfigurationDS xmlns=&quot;http://tempuri.org/ChartConfiguration.xsd&quot;&gt;&#xD;&#xA;  &lt;FieldConfiguration FieldConfiguration_Id=&quot;0&quot;&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;DataBinding&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;      &lt;Property&gt;&#xD;&#xA;        &lt;Name&gt;DataField&lt;/Name&gt;&#xD;&#xA;        &lt;Value&gt;22811&lt;/Value&gt;&#xD;&#xA;        &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;        &lt;CustomData /&gt;&#xD;&#xA;        &lt;Description /&gt;&#xD;&#xA;      &lt;/Property&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;FormatProperties&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;1&lt;/PropertyGroup_Id&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;  &lt;/FieldConfiguration&gt;&#xD;&#xA;&lt;/FieldConfigurationDS&gt;" Left="17375.04" Top="1166.401" Width="630" Height="288" Text="PrintTime" OutputFormat="HH:mm" Style="text-align: right; white-space: inherit" />
      <Control Type="AR.Field" Name="TextBox17" Tag="" Left="15035.04" Top="1166.401" Width="1260" Height="288" Text="Tulostusaika:" OutputFormat="dd.MM.yyyy" Style="white-space: inherit" />
      <Control Type="AR.Image" Name="Picture1" Left="15664.32" Top="0.0006866455" Width="2340.72" Height="879.84" LineColor="16777215" LineWeight="0" SizeMode="2">0D0D0004024F0C000089504E470D0A1A0A0000000D494844520000008500000041080200000070C1F0C90000000467414D410000B18F0BFC6105000000097048597300000EC200000EC20115284A8000000BF149444154785EED9BF75B564716C7F73FD9CD66B3C56C628C662DD14453D4D8A231A8A85151D428365414B16043110B566C8005C5DEB06041C582821A1B11141511156C60C18205DD8FCC7833EFDCB7A3BBF787FB7DCEE343EE393377EE7C674E9977F2A7D736AC049B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BE19DF15156F624232B67E2B4D5ED8226D76C38E0A39AC1FFFA4F6F43FE5ABD7BC316E1A1118B1256ECCE395FF8ECD90BD9EC2D2A2A5E3D7AF43475CF89F131C9813DA654ABFD475BE41FB57AFDBB6E9F660191616312D66E3A947FF5E6AB57AF644B4F888BDFD6BE7B347D76EA1923A46370CC88F14B9F3FD7C760466EDEB5DEA1737EEE1265B4752A7CF29849490CECE6ED7B2F5E56C8C67EE11DF0F1E4E9B33DE9A75A058EFFF327DDFEF26910FF7A94095357D14AB6AFEC61434A46939F46419B66E9543EA81E14BF7C976CEC169BB71FAD5E3F446B8EC077D1CD5269E41A93A6AFD11ABA123E9C5155ABF32B2BB2A4F4A16CEF3BAACA47E1F5DBC1FD676983F3284D7F1E5D50784BF4C076E9D0638A66E051068F5C2C9ABB417E41319B526B2884EDBB7DF77169E70257AFDDFEB1E39B45E6AB74EB3BE3DEFD47B2171F51253E20A355E0386D3486B0640CD15450281651DEA51B8D5A3A9F32B5B9B987A1A3E3C518DCA0D7A0395A2B433EFCACFBF4B91BDD3BBD2359397FFB3C586BE8A524AED8FDB2C21FC7E53F1F048C4123166AE3E03B091E3FFD3291F90A1FBB64586422323A2AA973EF69F59A0CF9E29B411860B67049AAE804CFAB3647987A2C71D9A22D423FEC86806E931BFC10F659837ED8FCF38B5E1BB71E113DB842D29A7D441DA35B9C89F1B7105EED7ECA525233557B7C290363677FDF7AA490C66D467EFB63448DAFFA9B3BFFBAF930E64776E40BFCE723EBB70BDA201871FF61F3AF5C958E4803F1F374767EF4CC75C3231385B35AB62A8D58ADF6C00C12695D79F6F2F2E769E9A73158B434D5FDD2BE7CA59899527BEE3B64DEE75F0F509F1057D41866C6CCF99B557B5603E3973A05C74EE675EE3555DBC11FD6E87129BF485AF8023FF978FCA49C65AB8E0061A6A4DA3B9837476CDCE6172F5E4A7515401AA6F50C432143E3D427C4DED3D9976503134AEE95050F70888B8C96F449AA1D71FFC1238D7E96E6EEFD27A5DA17F8C9C7DD9207DFB41AA18E80ECE8968BE13A0513D4B0F970B587EF5A4794DE2B93EA2A0057A66DBB590BB6F07CDA9C0D2C5BE3214ECF4D48BF78F9061EC93046587F52E70CEC3FD5F87FCD47F1AD52D53B23E4F852E71DF61D3C43A4517BC08FB97720DE802226A0EB24B55BD60D7907AAAD3BB328628CE77083F314ADCC389C79CEB014326FF136A9730606AF1A13268F1ECB953A5FE0271F45C525EAEB116641EABCC3AEBDBF1109D51E7A0E9CCD6C4AB5BFC0E3A97D22C63A257F25A15055F87DA13263CDC683AA258916B5AAD43943CB0E6355FBBFD7EA890B913A5FE0271FB7EFDCAFF35DA83A828FEBF659B7F990547B8153672FD76D3C44ED816FC83A715EAAFD42EE85429C9EDA67BFB0F946294042A1BD91AD23541A481C8885AA25DE98D45CAA4DD8B6EB985675F6E837D3BFBDEE271F0FCB9E98CB40FCCFCAB5FB096ED2C813B435851051F8B6070F1F4B0B1F11316199D6A116B1C956552D0376FA2EE276C7E018D5B26B9F19AEF62ECFC9EF556324F3B89F0BCB4F3EC0CEB413DA2010D2BEC01E5336A464B84A4554686B5008B97CEFD0393BF61CBF517457DA79878319D99A039C316F939616E3125503C209ADA44E41764E418DCA42C7909859EBA54E01A9E0854BD7A14AB544464D5CFEB4DCCF40E83F1FF8816E7DF5A118C24A9CBD30850F93D6CE70E7EE032D8731045628091392769DBF785D5A7B8296CEE2F1718952F71613A6AE1205A910D2B0F55B0E4B9D82BD074E1B3642824262891F4B56EE599A9C862C5FBD977FD98E9F7EA91F8EE1A9FCDEDFC07F3E407E413185A836205528C1C6C724BBF1BC878E9ED3B22C4D70F173176F25FB940D5C60F3F6A35A453667518AD429485E9FAEA6C21FD50C66D1489D02D68161E3BD90B00D1915EF5F596EA04A7C809CF385E6B24E935A8D06C62FDF450929DB3862FFA1336DBB44994FA854A1DA22AEC806CE40DC56EDEB370DCBCDBB26750AD20F9F55535EAA04730D4B68349F037914AA992D3B326517554055F900AC88B8F86DAE8E050D193725D9D54F0ED76FDCC5D733895A135528A7491664034768074DC8B2556952E7083C989608E172A5EE2DAE5CBDD5A4AD43D8F746181E5BCDEFB061E01DF021C06724AED84D5AC24AD1C66A086E575A3BC3D97357162D4D65B7998FE784E0D958E0D2FA2D28E93BF79EA69A7DD56C1889AF543B829A40738FE694F7D8C93CD500A9F3FDE0D69D26346F1729A455E038F62BD9B9668610515CB9012FF1CEF8106034D45F2448EAC98421A4B34EDD880A2AFF4DDB8E989316214CBDB47B8B95EBF66B36C412A2749FC1730F64649B4F706B7FEB5036D56B32442ADE02B7A31AE0D3E6276E27A9CDBF7A53087525695546560EBECEBCF8F61D3C233BF20BEF980F01B62DAC38FD6984E993466EC1AA5FBBE9905672221474C74FE649A3D7AF4B4A1F6A9B83FC82426C64652142CE4A80D532B416ED1D8A1E621BF32B75A4B02F2BA267AED30C0E679E936A1326CF580B61AA7D48585C5542FA7BE1438045D4B88D9ECEBA39323283E2E0937A7DD5E67CBCF1DB098033558BE0F1783E60F802E3096169CAAC756C3BD1E4D7D0B9860AA16439977B55A840C9BD32ED572C6A3D37E7A49459DA3752C9FF3F7FAF750F22B03A56645CF4CA8A0A6FAF22E0FDC44A5725366EB3D096973F1F18EE90087DD964E899DFAFA0D2D22D048F4FD2F1ECD90B7CA9FA1CBEA9364487E0527E9176A642AE25752ED0B9D754D51E292A2E913ADFF17EF9D8937E4A3B06A622933AEF402C519B234661613E20601F0895990F21A7B3F3274E5BAD9584496BF68956C0FC23DBA4E96BA4CE05DA7476382C21F8DFBE735FEA7CC7FBE563D58603EA5891319392BCFF61196FBE78D94EAD87D8B84DA81E3D2ED7269DC489D4483434F3413E1A357D3561890E29038DE7F0A1667DAB1D078CE586940CA97306D213AD226E161089D3936ADFF17EF96031AA634556288BD12370C4DA0D0FAA39760C2A428BFA1C21D714AD80C6078950764E8158070418958F6AB57BB368442BDCE3E8A824438530D7C201BAC2D4D91B547B64E8E878D68A54FB8EF7C807C156ABBA89C6A48952ED098407FC8FDA1CF921608CC85EC646AF549F33C569E97F8401838FEEFD628F1ECB557724C9ABCA07438203A1C2EF6BF4B7ED12E5E6274B028FF69B3CA20EC30FF8CC07096BCB0E63C9EE93D7A7BB3A987AF0F03189A039370F8D5884362E613B450071922A812AD2E9CD049254169AF9BACDA889CBD19E3C73898DA23E0FEE3F4B3D0F27E6936D6FDC7AC49C7AF2526D6024054285F3D1AABC61918942A5E1FA8DBBC415F36122D5E29DBBFEFC0C65C0673E02BABD39AD62E1E3919956F2964E3DDF5CBF64E8C32BAFE7906FF0DC5CBE32B9E257016A5DFE53F440F46BD4329CD9349A878D4920C5D4AA3621BC4B1CE39B838A56F93F2C7B82AF737A759331F05EA321C3181C21AFD6B1938CE742AAD70F61F119177C1071C7871CCCE9D52C8F77EC3CC2673E3E765C9842F82A4334952109496F6E78B2B429893515E2B1073C8370059597F01CBC0A5B41ADE9DCE3C4A98BEA27F03AC10759F882253B8CE77E081F58C5CBBBC0673EB4AB1BDE08BE85BC4534E70F2D03F6461AB60837028F769E8144C7AE152A6F4079AF2D29E145F1B16A15E993B0579626A7559D0CE0331F1468BCFE83EAEEB682214C3D2E28BFA05836AEFC6CE36A8CFB1EC45EA9D56820499A1A54C97755338F299006F6871A7B7885B87A4AD1D0BE7BB4F1DCBD88B1F1075D8584C5B1E945E75587CF7C50E21614DE22E924A0B50B9A5CBF691893CEA61142D8C0E79205850C8D5BB3F120198B395CB38E28834907A096FCA746837EB4327A20D8B27E3B06C7848F5DB23EE530D3A49DD21F3CF23B1128B0C79480AE93824262DD1C2E39056FA7A224C8F10A08A05C17075CF8AB94D44CF22BF57F24702AA215091E0964D1CD523A747F59D227F8CC878DF70A9B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C35AB0F9B0166C3EAC059B0F6BC1E6C34A78FDFABF54D607B61B13A17E0000000049454E44AE426082</Control>
      <Control Type="AR.Field" Name="TextBox14" Tag="&lt;FieldConfigurationDS xmlns=&quot;http://tempuri.org/ChartConfiguration.xsd&quot;&gt;&#xD;&#xA;  &lt;FieldConfiguration FieldConfiguration_Id=&quot;0&quot;&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;DataBinding&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;      &lt;Property&gt;&#xD;&#xA;        &lt;Name&gt;DataField&lt;/Name&gt;&#xD;&#xA;        &lt;Value&gt;22810&lt;/Value&gt;&#xD;&#xA;        &lt;PropertyGroup_Id&gt;0&lt;/PropertyGroup_Id&gt;&#xD;&#xA;        &lt;CustomData /&gt;&#xD;&#xA;        &lt;Description /&gt;&#xD;&#xA;      &lt;/Property&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;    &lt;PropertyGroup&gt;&#xD;&#xA;      &lt;FieldConfiguration_Id&gt;0&lt;/FieldConfiguration_Id&gt;&#xD;&#xA;      &lt;Name&gt;FormatProperties&lt;/Name&gt;&#xD;&#xA;      &lt;PropertyGroup_Id&gt;1&lt;/PropertyGroup_Id&gt;&#xD;&#xA;    &lt;/PropertyGroup&gt;&#xD;&#xA;  &lt;/FieldConfiguration&gt;&#xD;&#xA;&lt;/FieldConfigurationDS&gt;" Left="16205.04" Top="1166.401" Width="1170" Height="288" Text="PrintDate" OutputFormat="dd.MM.yyyy" Style="text-align: right; white-space: nowrap" />
      <Control Type="AR.Field" Name="TextBox12" Left="4088.16" Top="2324.161" Width="2040" Height="540" Text="Sideainesiilojen pinnat" HyperLink="4" Style="font-size: 12pt; font-weight: bold; text-align: center" />
      <Control Type="AR.Field" Name="TextBox18" Left="6330.241" Top="2324.161" Width="2040" Height="540" Text="Tuotannon laatutiedot" HyperLink="6" Style="font-size: 12pt; font-weight: bold; text-align: center" />
      <Control Type="AR.Field" Name="TextBox13" Left="8565.121" Top="2324.161" Width="2040" Height="540" Text="Tuotantotiedot vrk" HyperLink="8" Style="font-size: 12pt; font-weight: bold; text-align: center" />
      <Control Type="AR.Field" Name="TextBox20" Left="11370.24" Top="2341.441" Width="2220.481" Height="540" Text="Annosvaakasuhde" HyperLink="9" Style="font-size: 12pt; font-weight: bold" />
    </Section>
    <Section Type="PageHeader" Name="PageHeader1" Height="360" BackColor="16777215" />
    <Section Type="Detail" Name="Detail1" Height="360" BackColor="16777215" />
    <Section Type="PageFooter" Name="PageFooter1" Height="360" BackColor="16777215" />
    <Section Type="ReportFooter" Name="ReportFooter1" Height="360" BackColor="16777215" />
  </Sections>
  <ReportComponentTray />
  <Script><![CDATA[static int lineWidth = 2;

  

  
static System.Drawing.Color[] serieColors = new System.Drawing.Color[4]{
	System.Drawing.Color.Red,
	System.Drawing.Color.Blue,
	System.Drawing.Color.Black,
	System.Drawing.Color.Green
};

static System.Drawing.Color backColor = System.Drawing.Color.White;

static int labelFontSize = 12;
static int titleFontSize = 12;


const int graphCount = 4;
static string[] graphTitles = new string[graphCount]{"Kuvaaja1","Kuvaaja2","Kuvaaja3","Kuvaaja4"};

static string[] titles1 = new string[] {"Aika","Mittaus1","Mittaus2","Mittaus3","Mittaus4"};
static string[] titles2 = new string[] {"Aika","Mittaus1","Mittaus2","Mittaus3"};
static string[] titles3 = new string[] {"Aika","Mittaus1","Mittaus2","Mittaus3","Mittaus4"};
static string[] titles4 = new string[] {"Aika","Mittaus1","Mittaus2","Mittaus3","Mittaus4"};

static string[][] titlesList = new string[][]{titles1,titles2,titles3,titles4};


static string[] formats1 = new string[] {"line","line","line","points"};
static string[] formats2 = new string[] {"bar","bar","bar"};
static string[] formats3 = new string[] {"line","line","line","points"};
static string[] formats4 = new string[] {"line","line","line","points"};

static string[][] formatList = new string[][]{formats1,formats2,formats3,formats4};

static int[][] limitsAndIncrement1 = new int[][]{new int[]{500, 0, 50},new int[]{200, 0, 25},new int[]{250, 0, 25},new int[]{200, 0, 25}};
static int[][] limitsAndIncrement2 = new int[][]{new int[]{500, 0, 50},new int[]{200, 0, 25},new int[]{250, 0, 25},new int[]{200, 0, 25}};
static int[][] limitsAndIncrement3 = new int[][]{new int[]{500, 0, 50},new int[]{200, 0, 25},new int[]{250, 0, 25},new int[]{200, 0, 25}};
static int[][] limitsAndIncrement4 = new int[][]{new int[]{500, 0, 50},new int[]{200, 0, 25},new int[]{250, 0, 25},new int[]{200, 0, 25}};


static string[] tagList1 = new string[]{"sim1m_1:avg","sim1m_2:avg","sim1m_5:avg","sim1m_6:avg"};
static string[] tagList2 = new string[]{"sim1m_3:avg","sim1m_4:avg","sim1m_7:avg"};
static string[] tagList3 = new string[]{"sim1m_1:avg","sim1m_2:avg","sim1m_5:avg","sim1m_6:avg"};
static string[] tagList4 = new string[]{"sim1m_1:avg","sim1m_2:avg","sim1m_5:avg","sim1m_6:avg"};


static string[][] tagLists = new string[][]{tagList1,tagList2,tagList3,tagList4};

static int[][][] limitsAndIncrementsList = new int[][][]{limitsAndIncrement1,limitsAndIncrement2,limitsAndIncrement3,limitsAndIncrement4};

string tracerImageLink = @"D:\DNA\Data\IA\DNAreport\RAUTI\Briketöinti\etc\test.png";
string tracerPathTemplate = "http://localhost/DNA/DNATracer?report=_Templates/Trend&tags=";

string header = "Briketöintilaitos";
string header2 = "PROSESSIN SEURANTA";

float spacer = 1.5f;
float yStart = 2.0f;
float graphHeight = 8.0f;
float xStart = 0.45f;
float graphWidth = 12.0f;
float reportWidth = 14.0f;

public void ActiveReport_ReportStart()
{

	TextBox headerBox = new TextBox();
	headerBox.Text = header;
	headerBox.Left = 0.1f;
	headerBox.Width = reportWidth - 1.2f;
	headerBox.Height = 0.35f;
	headerBox.Style = "color: #00005A; font-size: 20pt; font-weight: bold; text-align: center; vertical-align: middle; white-space: nowrap; ddo-char-set: 1";
	rpt.Sections["ReportHeader1"].Controls.Add(headerBox);
	
	TextBox headerBox2 = new TextBox();
	headerBox2.Text = header2;
	headerBox2.Top = headerBox.Height;
	headerBox2.Left = 0f;
	headerBox2.Width = reportWidth - 1.0f;
	headerBox2.Height = 0.35f;
	headerBox2.Style = "color: #00005A; font-size: 16pt; font-weight: bold; text-align: center; vertical-align: middle; white-space: nowrap; ddo-char-set: 1";
	rpt.Sections["ReportHeader1"].Controls.Add(headerBox2);
	
	Shape headerRect = new Shape();
	headerRect.Top = 0.4f + headerBox.Height + headerBox2.Height;
	headerRect.Left = 0.7f;
	headerRect.Width = reportWidth - 2.2f;
	headerRect.Height = 0.25f;
	headerRect.BackColor = System.Drawing.Color.FromArgb(0, 0, 90);
	rpt.Sections["ReportHeader1"].Controls.Add(headerRect);
	

	

	for (int i = 0; i < graphCount; i++){

		System.Data.DataSet[] dsList = getDataSets(tagLists[i], i);

		System.Data.DataSet dsHistoryData = dsList[0];
		System.Data.DataSet dsTagInfo = dsList[1];
		int seriesCount = tagLists[i].Length;
		setReportConfigs(dsHistoryData);

		
		CustomControl currControl = new  CustomControl(new Steema.TeeChart.TChart().GetType());
		Steema.TeeChart.TChart currChart = (Steema.TeeChart.TChart) currControl.Control;
		
		currControl.Height = graphHeight;
		currControl.Width = graphWidth;
		currControl.Left = xStart;
		currControl.Top = yStart + i * (graphHeight + spacer);
		
		
		
		Picture tracerLink = new Picture();
		System.Drawing.Image img  = System.Drawing.Image.FromFile(tracerImageLink);
		tracerLink.Image = img;
		tracerLink.Name = "Pic"+(i+1).ToString();
		tracerLink.Top = yStart + (i+1)*(spacer + graphHeight)- 2.5f;
		tracerLink.Left = xStart + graphWidth - 0.2f ;
		tracerLink.Width = 0.3f;
		tracerLink.Height = 0.3f;
		
		string tracerHyperLink = tracerPathTemplate;
		for(int serieNr = 0; serieNr < seriesCount; serieNr++){
			tracerHyperLink = tracerHyperLink + tagLists[i][serieNr].Split(':')[0];
			if(serieNr != seriesCount - 1){
				tracerHyperLink = tracerHyperLink + "&tags=";
			}
		}
		string startTime = System.DateTime.Parse(g_Parameters["startTime"]).ToString("s");
		string endTime = System.DateTime.Parse(g_Parameters["endTime"]).ToString("s");
		tracerHyperLink = tracerHyperLink + "&RelativeStartTime=" + startTime + "&RelativeEndTime=" + endTime;
		tracerLink.HyperLink = tracerHyperLink;
		


		

		
		currChart.Panel.MarginBottom = 5;
		currChart.Panel.MarginLeft = 8;
		currChart.Panel.MarginRight = 8;
		currChart.Panel.MarginTop = 5;
	
		currChart.Header.Visible = true;
		currChart.Header.Text = graphTitles[i];
		currChart.Header.Font.Size = 15;
		currChart.Header.Font.Color = System.Drawing.Color.Black;
		currChart.BackColor = backColor;
		
		currChart.Legend.Visible = false;
		currChart.Aspect.View3D = false;	
		currChart.Legend.Visible = false;
		currChart.Legend.Alignment = Steema.TeeChart.LegendAlignments.Bottom;
		currChart.Legend.Shadow.Visible = false;
		currChart.Panel.Brush.Visible = true;
		currChart.Panel.Bevel.Inner = Steema.TeeChart.Drawing.BevelStyles.None;
		currChart.Panel.Bevel.Outer = Steema.TeeChart.Drawing.BevelStyles.None;

		createCustomAxes(currChart);
		formatSeries(currChart, dsHistoryData, formatList[i]);
		formatAxes(currChart, titlesList[i], formatList[i], limitsAndIncrementsList[i]);
		buildLegend(dsTagInfo, i);


	

		rpt.Sections["ReportHeader1"].Controls.Add(currControl);
		rpt.Sections["ReportHeader1"].Controls.Add(tracerLink);


	}


	

	

	
}

public void formatAxes(Steema.TeeChart.TChart chart, string[] titleList, string[] formatList, int[][] limits){

	
	Steema.TeeChart.Axis[] axisList = new Steema.TeeChart.Axis[5]{
		chart.Axes.Bottom,
		chart.Axes.Left,
		chart.Axes.Right,
		chart.Axes.Custom[0],
		chart.Axes.Custom[1]
		};
	
	int length = axisList.Length;
	int titleListLength = titleList.Length;
	int[] angleList = new int[4]{90,270,90,270};

	
	for (int i = 0; i < length; i++){

		if(i == 0){
			axisList[0].Title.Font.Size = titleFontSize;
			axisList[0].Labels.Font.Size = labelFontSize - 2;
		}
		
		if(i < titleListLength){
			axisList[i].Title.Text = titleList[i]; // TÄSSÄ
		}

		if(i >= titleListLength){
			//chart.Series[i - 1].Visible = false;
			axisList[i].Visible = false;
		}

		if(i == 3){
			axisList[i].OtherSide = false;
			axisList[i].RelativePosition = -8;

		}
		
		
		
		if(i == 4){
			axisList[i].OtherSide = true;
			axisList[i].RelativePosition = -8;
		}

		if(i != 0){

			axisList[i].Automatic = false;
			axisList[i].AutomaticMaximum = false;
			axisList[i].AutomaticMinimum = false;
			axisList[i].Maximum = limits[i - 1][0];
			axisList[i].Minimum = limits[i - 1][1];
			axisList[i].Increment = limits[i - 1][2];
			axisList[i].Title.Angle = angleList[i - 1];
			
			axisList[i].Title.Font.Size = titleFontSize;
			axisList[i].Labels.Font.Size = labelFontSize;
			axisList[i].Title.Font.Color = serieColors[i - 1];
			axisList[i].Labels.Font.Color = serieColors[i - 1];
		}
		


	}
	
	chart.Axes.Bottom.Labels.DateTimeFormat = "hh:mm ddd";

	int seriesCount = chart.Series.Count;
	
	
	
	for (int j = 0; j < seriesCount; j++){

		if(j == 0){
			chart.Series[j].VertAxis = Steema.TeeChart.Styles.VerticalAxis.Right;
		}
		else{
			chart.Series[j].VertAxis = Steema.TeeChart.Styles.VerticalAxis.Custom;

		}
		chart.Series[j].HorizAxis = Steema.TeeChart.Styles.HorizontalAxis.Bottom;

	}

}

public void formatSeries(Steema.TeeChart.TChart chart, System.Data.DataSet ds, string[] formatList){

	int length = formatList.Length;
	
	
	for (int i = 0; i < length; i++){
		if(formatList[i] == "points"){
			Steema.TeeChart.Styles.Points points = new Steema.TeeChart.Styles.Points();
			points.DataSource = ds.Tables["Values"];
			points.XValues.DataMember = "ts";
			points.XValues.DateTime = true;
			points.YValues.DataMember = "value"+i.ToString();
			points.CheckDataSource();
			points.Color = serieColors[i];
			
			if(i == 2){
				points.CustomVertAxis = chart.Axes.Custom[0];
			}
			if(i == 3){
				points.CustomVertAxis = chart.Axes.Custom[1];
			}
			
			chart.Series.Add(points);
		}
		else if(formatList[i] == "line"){
		
			Steema.TeeChart.Styles.Line line = new Steema.TeeChart.Styles.Line();
			line.DataSource = ds.Tables["Values"];
			line.LinePen.Width = lineWidth;
			line.XValues.DataMember = "ts";
			line.XValues.DateTime = true;
			line.YValues.DataMember = "value"+i.ToString();
			line.CheckDataSource();
			line.Color = serieColors[i];
			
			if(i == 2){
				line.CustomVertAxis = chart.Axes.Custom[0];
			}
			if(i == 3){
				line.CustomVertAxis = chart.Axes.Custom[1];
			}
			
			chart.Series.Add(line);
		}
		else if(formatList[i] == "bar"){
		
			Steema.TeeChart.Styles.Bar bar = new Steema.TeeChart.Styles.Bar();
			bar.DataSource = ds.Tables["Values"];
			//line.LinePen.Width = lineWidth;
			bar.XValues.DataMember = "ts";
			bar.XValues.DateTime = true;
			bar.YValues.DataMember = "value"+i.ToString();
			bar.CheckDataSource();
			bar.Color = serieColors[i];
			bar.MultiBar = Steema.TeeChart.Styles.MultiBars.Side;
			bar.Marks.Visible = false;
			bar.BarWidthPercent = 70;


			
			if(i == 2){
				bar.CustomVertAxis = chart.Axes.Custom[0];
			}
			if(i == 3){
				bar.CustomVertAxis = chart.Axes.Custom[1];
			}
			
			chart.Series.Add(bar);
		}
	}


}

public System.Data.DataSet[] getDataSets(string[] tagStringList, int j){

	Metso.DNA.IA.DNAdata.Interfaces.IDNAdataObject dobj = 
		(Metso.DNA.IA.DNAdata.Interfaces.IDNAdataObject) Metso.DNA.IA.DNAdata.RemoteUtils.CreateRemote("DNAdataObject");
	
	string startTimeSTR = g_Parameters[0];
	string endTimeSTR = g_Parameters[1];
	

	DateTime startTime = DateTime.Parse(startTimeSTR);
	DateTime endTime = DateTime.Parse(endTimeSTR);
	System.Collections.Generic.List <string> tagNameList = new System.Collections.Generic.List<string> ();
	System.Collections.Generic.List <string> operationList = new System.Collections.Generic.List<string> ();

	
	
	
	for(int i = 0; i < tagStringList.Length; i++){

		string tagString = tagStringList[i];

		string tagName = tagString.Split(':')[0];
		string operation = tagString.Split(':')[1];

		tagNameList.Add(tagName);
		operationList.Add(operation);
		
	}
	string[] tagNameListArray = tagNameList.ToArray();
	string[] operationListArray = operationList.ToArray();
	

	
	string[] period = new string[1];
	period[0] = TimeSpan.FromMinutes(endTime.Subtract(startTime).TotalMinutes/ 20 ).ToString(@"dd\.hh\:mm");
	string[] optionsList = new string[1];
	optionsList[0] = "TS_START";


	System.Data.DataSet dataQuery = (System.Data.DataSet) (dobj.InvokeMethod("Combination", "localhost" + "/Query.BasicQueries.Extended", null, startTime, endTime, period, optionsList, tagNameListArray, operationListArray, new string[]{"(null)"}, new string[]{"(null)"}, new string[]{"(null)"}, new string[]{"(null)"}, new string[]{"(null)"}));
	System.Data.DataSet tagInfoQuery = (System.Data.DataSet) (dobj.InvokeMethod("TagInformation_List", "localhost" + "/Query.BasicQueries.Information", null, tagNameListArray, "(null)"));
	if(dataQuery.Tables.Count == 0)
	{
		throw new Exception("No data");
	}
	System.Data.DataSet[] dsList = new System.Data.DataSet[]{dataQuery, tagInfoQuery};
	
	return dsList;
}
public void createCustomAxes(Steema.TeeChart.TChart chart){
	
	Steema.TeeChart.Axis Custom0 = new Steema.TeeChart.Axis(chart.Chart);
	Steema.TeeChart.Axis Custom1 = new Steema.TeeChart.Axis(chart.Chart);
	
	Custom0.AxisPen.Visible = true;
	Custom0.Grid.Visible = false;
	
	Custom1.AxisPen.Visible = true;
	Custom1.Grid.Visible = false;
	
	chart.Axes.Left.Grid.Visible = true;
	chart.Axes.Right.Grid.Visible = false;
	
	chart.Axes.Custom.Add(Custom0);
	chart.Axes.Custom.Add(Custom1);
}

public void setReportConfigs(System.Data.DataSet ds){
	// Custom printer settings: fixes broken charts that are in page break position
	rpt.Document.Printer.PrinterName = "";
	rpt.PageSettings.PaperKind = System.Drawing.Printing.PaperKind.Custom;
	// Config -> 35000 so graphs place evenly (one tall paper), might break printing somehow
	rpt.Document.Printer.PaperSize = new System.Drawing.Printing.PaperSize("CustomSize", 1000, 35000);
	rpt.PrintWidth = reportWidth;
	
	
	rpt.DataSource = ds;
	rpt.DataMember = "Values";
	rpt.UserData = "";
}

public void buildLegend(System.Data.DataSet tagInfo, int j ){

	string[] texts = new string[3]{"Description", "TagName", "Unit"};
	string[] textsFin = new string[3]{"Kuvaus", "Positio", "Yksikkö"};
	float[] widths = new float[3]{3.0f, 3.0f, 3.0f};
	float colHeight = 0.2f;
	

	for (int column = 0; column < texts.Length; column++){
	

		for(int row = 0; row < tagInfo.Tables[0].Rows.Count; row++){
			if(row == 0){
				TextBox boxColumnHeader = new TextBox();
				string textColumnHeader = textsFin[column];
				if(textColumnHeader == "" && column == 0)textColumnHeader = "This is a testing description";
				if(textColumnHeader == "" && column == 2)textColumnHeader = "kg/nm3";
				boxColumnHeader.Height = colHeight;
				boxColumnHeader.Top = yStart + (j + 1) * (graphHeight)+ j * spacer + (row  * colHeight) - 0.02f ;
				boxColumnHeader.Left = graphWidth / 8 + (column * ( graphWidth / 4));
				boxColumnHeader.Text = textColumnHeader;
				boxColumnHeader.Style = "font-size: 11pt";
				boxColumnHeader.ForeColor = serieColors[2];
				boxColumnHeader.Width = widths[column];
				rpt.Sections["ReportHeader1"].Controls.Add(boxColumnHeader);
			}
			TextBox box = new TextBox();
			string text = tagInfo.Tables[0].Rows[row][texts[column]].ToString();
			if(text == "" && column == 0)text = "This is a testing description";
			if(text == "" && column == 2)text = "kg/nm3";
			box.Height = colHeight;
			box.Top = yStart + (j + 1) * (graphHeight)+ j * spacer + (row * colHeight) + colHeight;
			box.Left = graphWidth / 8 + (column * ( graphWidth / 4));
			box.Text = text;
			box.ForeColor = serieColors[row];
			box.Width = widths[column];
			rpt.Sections["ReportHeader1"].Controls.Add(box);
		}

	}


}



]]></Script>
  <PageSettings />
  <Parameters />
</ActiveReportsLayout>